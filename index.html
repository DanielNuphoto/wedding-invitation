<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>é¡æœ±åºœå›å®´å–œå¸–</title>
  <meta property="og:title" content="é¡æœ±åºœå›å®´å–œå¸–" />
  <meta property="og:description" content="é‚€è«‹å¤§å®¶ä¸€èµ·ä¾†è¦‹è­‰æˆ‘å€‘çš„å¹¸ç¦æ™‚åˆ»" />
  <meta property="og:image" content="https://danielnuphoto.github.io/wedding-invitation/image.jpg" >
  <meta property="og:image:width" content="720" >
  <meta property="og:image:height" content="540" >
  <link rel="icon" href="favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Wix+Madefor+Text:ital,wght@0,400..800;1,400..800&display=swap" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100..900&display=swap" />
  <style>
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #5a7d9a; /* è«è˜­è¿ªè— */
      font-family: Wix Madefor Text, Noto Sans TC;
    }

    .container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      margin: 0;
      font-family: sans-serif;
      position: relative;
      width: 100dvw;
      height: 100dvh;
    }

    .instruction {
      width: 100%;
      position: absolute;
      bottom: calc(100% + 10px);
      font-size: 24px;
      color: #ffffff;
      text-align: center;
      transition: font-size 1s ease, opacity 1s ease;
      opacity: 1;
      transform-origin: top center;
    }

    .instruction.shrink {
      font-size: 20px;
      opacity: 0.7;
    }

    .card-container {
      position: relative;
      width: 50dvw;
      aspect-ratio: 4/3;
      perspective: 1000px;
      z-index: 1;
    }

    @media (max-width: 992px) {
      .card-container {
        width: 90dvw;
      }
    }

    .card {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.8s;
      cursor: pointer;
      transform: rotateY(0deg);
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .front {
      background: #000;
    }

    .back {
      transform: rotateY(180deg);
      background: #fff;
    }

    video, img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .controls-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0;
    }

    .btns {
      display: flex;
      flex-wrap: nowrap;
      transition: all 0.5s ease;
    }

    .btn {
      margin-top: 15px;
      padding: 12px 36px;
      font-size: 24px;
      border-radius: 999px;
      background: #6c8e7c;
      color: #fff;
      cursor: pointer;
      transition: all 0.5s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      white-space: nowrap;
    }

    .fade {
      opacity: 0.8;
    }

    button {
      padding: 0;
      border: none;
    }

    .btn-icon {
      margin-top: 20px;
      margin-right: 0;
      width: 0;
      height: 63px;
      border-radius: 999px;
      background: #6c8e7c;
      color: #fff;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0);
      transition: opacity 0.5s ease, transform 0.5s ease, width 0.5s ease, height 0.5s ease, margin 0.5s ease, border-width 0.5s ease, box-shadow 0.5s ease;
      opacity: 0;
      transform: scale(0.5) rotateY(-180deg);
      overflow: hidden;
      pointer-events: none;
    }

    .btn-icon.visible {
      width: 63px;
      margin-right: 20px;
      opacity: 1;
      transform: scale(1) rotateY(0deg);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      pointer-events: auto;
    }

    .btn-icon div {
      width: 36px;
      height: 36px;
      font-size: 36px;
    }

    @media (min-width: 992px) {
      .btn:hover, .btn-icon:hover {
        background: #749d87;
      }

      .credits .vivipic-link:hover {
        opacity: 1;
      }

      .credits .vivipic-link:hover .vivipic-logo {
        transform: scale(1.1);
      }

      .credits .vivisticker-link:hover {
        opacity: 1;
      }

      .credits .vivisticker-link:hover .vivisticker-logo {
        transform: scale(1.1);
      }
    }

    .hidden {
      display: none;
    }

    @keyframes breathe {
      0% { transform: scale(1.0); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1.0); }
    }

    .breathe {
      animation: breathe 1.2s infinite ease-in-out;
    }

    .toast {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: rgba(0, 0, 0, 0.5);
      color: #fff;
      padding: 12px 24px;
      border-radius: 16px;
      font-size: 16px;
      opacity: 0;
      transition: opacity 0.2s ease, transform 0.2s ease;
      pointer-events: none;
      z-index: 1000;
      white-space: nowrap;
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .modal-overlay.show {
      opacity: 1;
      pointer-events: auto;
    }

    .modal-content {
      background: #6c8e7c;
      padding: 40px 60px;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      text-align: center;
      transform: scale(0.8);
      transition: transform 0.3s ease;
      max-width: 80%;
    }

    .modal-overlay.show .modal-content {
      transform: scale(1);
    }

    .modal-text {
      font-size: 28px;
      color: white;
      font-weight: 500;
      margin: 0;
    }

    @media (max-width: 768px) {
      .modal-content {
        padding: 30px 40px;
      }

      .modal-text {
        font-size: 22px;
      }
    }

    @media (max-width: 480px) {
      .modal-content {
        padding: 25px 30px;
      }

      .modal-text {
        font-size: 18px;
      }
    }

    .credits {
      position: fixed;
      bottom: 15px;
      right: 15px;
      font-size: 12px;
      color: rgba(255, 255, 255, 0.6);
      text-align: right;
      line-height: 1.6;
      z-index: 100;
      pointer-events: none;
    }

    .credits > div {
      margin-bottom: 2px;
    }

    .credits .vivipic-link {
      display: inline-block;
      pointer-events: auto;
      cursor: pointer;
      opacity: 0.8;
      transition: opacity 0.2s ease;
    }

    .credits .vivipic-logo {
      display: inline-block;
      vertical-align: middle;
      height: 14px;
      width: auto;
      margin-left: 3px;
    }

    /* second logo (vivisticker) - shares similar behavior */
    .credits .vivisticker-link {
      display: inline-block;
      pointer-events: auto;
      cursor: pointer;
      opacity: 0.8;
      transition: opacity 0.2s ease;
    }

    .credits .vivisticker-logo {
      display: inline-block;
      vertical-align: middle;
      height: 13px;
      width: auto;
      margin-left: 3px;
    }

    /* container to control logo stacking/inline behavior */
    .credits .logos {
      display: inline-flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
    }

    /* Mobile Portrait - Reduce sizes for better balance */
    @media (max-aspect-ratio: 1/1) and (max-width: 768px) {
      .instruction {
        font-size: 18px;
        bottom: calc(100% + 5px);
      }

      .instruction.shrink {
        font-size: 16px;
      }

      .btn {
        margin-top: 12px;
        padding: 10px 24px;
        font-size: 18px;
      }

      .btn-icon {
        margin-top: 12px;
        height: 50px;
      }

      .btn-icon.visible {
        width: 50px;
        margin-right: 12px;
      }

      .btn-icon div {
        width: 28px;
        height: 28px;
        font-size: 28px;
      }

      .toast {
        bottom: 60px;
        font-size: 14px;
        padding: 10px 20px;
      }

      .credits {
        font-size: 7px;
        bottom: 8px;
        right: 8px;
        left: 8px;
        text-align: center;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap;
      }

      .credits > div {
        margin-bottom: 0;
        white-space: nowrap;
      }

      .credits > div:not(:last-child)::after {
        content: '|';
        margin-left: 8px;
        opacity: 0.5;
      }

      .credits .vivipic-logo {
        height: 9px;
        width: auto;
        margin-left: 2px;
        margin-bottom: 1px;
      }

      /* in narrow/portrait (vertical) layout, stack logos vertically */
      .credits .logos {
        flex-direction: row;
        gap: 4px;
        align-items: center;
      }

      .credits .vivisticker-logo {
        height: 8.5px;
        margin-left: 2px;
        margin-bottom: 2px;
      }
    }

    /* Landscape Mode - Horizontal layout */
    @media (max-height: 600px) and (orientation: landscape) {
      .container {
        flex-direction: row;
        align-items: center;
        justify-content: center;
        gap: 20px;
        box-sizing: border-box;
      }

      .card-container {
        width: auto;
        height: 80dvh;
        aspect-ratio: 4/3;
        flex-shrink: 0;
      }

      .instruction {
        font-size: 18px;
        bottom: calc(100% + 6px);
      }

      .instruction.shrink {
        font-size: 16px;
      }

      .controls-container {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 14px;
        flex-shrink: 0;
      }

      .btns {
        margin-top: 0;
      }

      .btn {
        margin-top: 0;
        padding: 10px 24px;
        font-size: 18px;
      }

      .btn-icon {
        margin-top: 0;
        height: 48px;
      }

      .btn-icon.visible {
        width: 48px;
        margin-right: 12px;
      }

      .btn-icon div {
        width: 28px;
        height: 28px;
        font-size: 28px;
      }

      .toast {
        bottom: 30px;
        font-size: 14px;
        padding: 10px 20px;
      }

      .credits {
        font-size: 8px;
        bottom: 8px;
        right: 8px;
        display: block;
        text-align: right;
      }

      .credits > div {
        margin-bottom: 2px;
      }

      .credits > div:not(:last-child)::after {
        content: none;
      }

      .credits .vivipic-logo {
        height: 10px;
        width: auto;
        margin-left: 3px;
      }

      /* in landscape/horizontal layout, show logos inline (row) */
      .credits .logos {
        flex-direction: column;
        justify-content: center;
        align-items: flex-start;
      }

      .credits .vivisticker-logo {
        height: 9px;
        width: auto;
        margin-left: 3px;
      }
    }

    /* Extra small landscape devices */
    @media (max-height: 450px) and (orientation: landscape) {
      .card-container {
        height: 80dvh;
      }

      .instruction {
        font-size: 14px;
      }

      .instruction.shrink {
        font-size: 12px;
      }

      .btn {
        padding: 8px 18px;
        font-size: 15px;
      }

      .btn-icon {
        height: 42px;
      }

      .btn-icon.visible {
        width: 42px;
        margin-right: 10px;
      }

      .btn-icon div {
        width: 24px;
        height: 24px;
        font-size: 24px;
      }

      .controls-container {
        gap: 12px;
      }

      .credits {
        font-size: 7px;
        bottom: 6px;
        right: 6px;
        display: block;
        text-align: right;
      }

      .credits > div {
        margin-bottom: 2px;
      }

      .credits > div:not(:last-child)::after {
        content: none;
      }

      .credits .vivipic-logo {
        height: 8px;
        width: auto;
        margin-left: 3px;
      }

      .credits .vivisticker-logo {
        height: 7px;
        width: auto;
        margin-left: 3px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card-container">
      <div class="instruction" id="instruction">è¼•è§¸æˆ–æ»‘å‹•å–œå¸–å³å¯ç¿»é¢</div>
      <div class="card" id="flipCard">
        <div class="card-face front">
          <video src="video.mp4?ver=2" autoplay loop muted playsinline poster="image.jpg?ver=2"></video>
        </div>
        <div class="card-face back">
          <video src="video-back.mp4?ver=3" autoplay loop muted playsinline poster="image-back.jpg?ver=2"></video>
        </div>
      </div>
    </div>
    <div class="controls-container">
      <div class="btns">
        <button id="audioRestartBtn" class="btn-icon" title="é‡æ–°æ’­æ”¾">
          <div class="material-symbols-outlined">
            play_circle
          </div>
        </button>
        <button id="audioToggleBtn" class="btn-icon" title="æ’­æ”¾">
          <div id="audioToggleBtnInner" class="material-symbols-outlined">
            play_arrow
          </div>
        </button>
        <button id="audioSoundBtn" class="btn breathe">ğŸ”Š é–‹å•Ÿè²éŸ³</button>
      </div>
      <button id="mapBtn" class="btn breathe">ğŸ“ æŸ¥çœ‹åœ°å€</button>
      <button id="calendarBtn" class="btn breathe">ğŸ“… åŠ å…¥è¡Œäº‹æ›†</button>
    </div>
  </div>
  <div id="toast" class="toast"></div>

  <div id="modal" class="modal-overlay">
    <div class="modal-content">
      <p class="modal-text">è¨˜å¾—æ˜¯ 11:30 é–‹å§‹å…¥å ´å–”ï¼</p>
    </div>
  </div>

  <div class="credits">
    <div>Created by é¡å»·å®‰</div>
    <div>Reviewed by æœ±ç´‹ç·£</div>
    <div>
      Powered by
      <div class="logos">
        <a href="https://vivipic.com" target="_blank" rel="noopener noreferrer" class="vivipic-link">
          <img src="logo.svg" alt="Vivipic" class="vivipic-logo">
        </a>
        <a href="https://vivisticker.com/" target="_blank" rel="noopener noreferrer" class="vivisticker-link">
          <img src="logo2.svg" alt="Vivisticker" class="vivisticker-logo">
        </a>
      </div>
    </div>
  </div>

  <audio id="audioTrack" src="audio.m4a?ver=2" loop></audio>

  <script>
  const card = document.getElementById('flipCard');
  const audioTrack = document.getElementById('audioTrack');
  const audioRestartBtn = document.getElementById('audioRestartBtn');
  const audioToggleBtn = document.getElementById('audioToggleBtn');
  const audioToggleBtnInner = document.getElementById('audioToggleBtnInner');
  const audioSoundBtn = document.getElementById('audioSoundBtn');
  const mapBtn = document.getElementById('mapBtn');
  const calendarBtn = document.getElementById('calendarBtn');
  const instruction = document.getElementById('instruction');
  const toast = document.getElementById('toast');
  const modal = document.getElementById('modal');
  let startX = 0;
  let rotation = 0;
  let isDragging = false;
  let dragHandled = false;
  let initial = true;
  let toastTimeout;

  function showToast(message) {
    toast.textContent = message;
    toast.classList.add('show');
    
    clearTimeout(toastTimeout);
    toastTimeout = setTimeout(() => {
      toast.classList.remove('show');
    }, 1000);
  }

  function showModal(callback) {
    modal.classList.add('show');
    setTimeout(() => {
      modal.classList.remove('show');
      if (callback) callback();
    }, 2000);
  }

  // Close modal when clicking on overlay
  modal.addEventListener('click', (e) => {
    if (e.target === modal) {
      modal.classList.remove('show');
    }
  });

  setTimeout(() => {
    instruction.classList.add('shrink');
  }, 3000);

  card.addEventListener('click', () => {
    if (dragHandled) {
      dragHandled = false;
      return;
    }
    rotation += 180;
    card.style.transform = `rotateY(${rotation}deg)`;
  });

  function handleDragStart(e) {
    isDragging = true;
    dragHandled = false;
    startX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
  }

  function handleDragEnd(e) {
    if (!isDragging) return;
    isDragging = false;
    let endX = e.type.includes('touch') ? e.changedTouches[0].clientX : e.clientX;
    if (Math.abs(endX - startX) > 50) {
      dragHandled = true;
      if (endX < startX) {
        rotation -= 180;
      } else {
        rotation += 180;
      }
      card.style.transform = `rotateY(${rotation}deg)`;
    }
  }

  document.body.addEventListener('touchstart', handleDragStart);
  document.body.addEventListener('touchend', handleDragEnd);
  document.body.addEventListener('mousedown', handleDragStart);
  document.body.addEventListener('mouseup', handleDragEnd);

  audioSoundBtn.addEventListener('click', () => {
    if (initial) {
      initial = false;
      audioRestartBtn.classList.add('visible')
      audioToggleBtn.classList.add('visible')
      audioTrack.currentTime = 0;
      audioTrack.play();
      audioToggleBtnInner.textContent = 'pause';
      audioToggleBtn.title = 'æš«åœ';
      audioSoundBtn.classList.remove('breathe')
      audioSoundBtn.classList.add('fade')
      audioSoundBtn.textContent = 'ğŸ”‡ é—œé–‰è²éŸ³'
    } else {
      audioTrack.muted = !audioTrack.muted
      audioSoundBtn.classList.toggle('fade')
      audioSoundBtn.classList.toggle('breathe')
      if (audioTrack.muted) {
        audioSoundBtn.textContent = 'ğŸ”Š é–‹å•Ÿè²éŸ³'
      } else {
        audioSoundBtn.textContent = 'ğŸ”‡ é—œé–‰è²éŸ³'
      }
    }
  });

  audioRestartBtn.addEventListener('click', () => {
    audioTrack.currentTime = 0;
    audioTrack.play();
    audioToggleBtnInner.textContent = 'pause';
    audioToggleBtn.title = 'æš«åœ';
    showToast('é‡æ–°æ’­æ”¾');
  });

  audioToggleBtn.addEventListener('click', () => {
    if (audioTrack.paused) {
      audioTrack.play();
      audioToggleBtnInner.textContent = 'pause';
      audioToggleBtn.title = 'æš«åœ';
      showToast('ç¹¼çºŒæ’­æ”¾');
    } else {
      audioTrack.pause();
      audioToggleBtnInner.textContent = 'play_arrow';
      audioToggleBtn.title = 'æ’­æ”¾';
      showToast('å·²æš«åœ');
    }
  });

  mapBtn.addEventListener('click', () => {
    window.open('https://www.google.com/maps/dir//708å°å—å¸‚å®‰å¹³å€åŸå¹³è·¯1è™Ÿ/@22.9918224,120.069466,12z/data=!4m8!4m7!1m0!1m5!1m1!1s0x346dd8acbf1b4465:0xf4ab14aaf3caa61c!2m2!1d120.1518676!2d22.9918437?entry=ttu', '_blank');
  });

  function downloadICS() {
    showModal(() => {
      const event = {
        title: 'é¡æœ±åºœå›å®´',
        start: '20260117T113000',
        end: '20260117T150000',
        location: 'https://maps.app.goo.gl/P4R37WntSKMsvqw77',
        description: 'é¡æœ±åºœå›å®´ https://danielnuphoto.github.io/wedding-invitation/',
        URL: 'https://danielnuphoto.github.io/wedding-invitation/'
      };

      const icsContent = [
        'BEGIN:VCALENDAR',
        'VERSION:2.0',
        'PRODID:-//Wedding Invitation//NONSGML v1.0//EN',
        'CALSCALE:GREGORIAN',
        'METHOD:PUBLISH',
        'X-WR-CALNAME:é¡æœ±åºœå›å®´',
        'X-WR-TIMEZONE:Asia/Taipei',
        'BEGIN:VEVENT',
        `DTSTART:${event.start}`,
        `DTEND:${event.end}`,
        `DTSTAMP:${new Date().toISOString().replace(/[-:]/g, '').split('.')[0]}Z`,
        `SUMMARY:${event.title}`,
        `LOCATION:${event.location}`,
        `URL:${event.URL}`,
        `DESCRIPTION:${event.description}`,
        'STATUS:CONFIRMED',
        'SEQUENCE:0',
        'END:VEVENT',
        'END:VCALENDAR'
      ].join('\r\n');

      const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'é¡æœ±åºœå›å®´.ics';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(link.href);
    });
  }

  calendarBtn.addEventListener('click', downloadICS);
  </script>
</body>
</html>
